## 一問一答
<details>
<summary>プレースホルダとは？</summary>
プレースホルダは「危険な値を直接書かず、安全に後から埋め込むための仕組み」。SQLインジェクション対策では“クエリと値を分離”する最重要手法。AWS では機密値を隠すために使う。
</details>


<details>
<summary>API Gateway オーソライザとは？</summary>
API の前で認証・認可を行い、不正リクエストを通さないフィルタ。Lambda・JWT・IAM の3方式があり、用途に応じて選ぶ。

Cognito を使えばオーソライザは不要？
→ 必要。Cognito の JWT をチェックする仕組みが API Gateway 側に必要。
</details>


<details>
<summary>Windows Serverとは？</summary>

個人向け Windows には無い 企業用のサーバー機能 が入っている。見た目は Windows に似ているけれど、会社全体をまとめて管理する専用の機能が入っている。特に有名なのが以下。

```sh
● Active Directory （AD DS）
→ 社員アカウント管理、ログイン管理、グループ管理
→ 大企業・学校・官公庁ほぼすべてが使用

● DNS サーバー
→ ドメイン名の解決（AD の心臓部）

● DHCP（オプション）
→ IPアドレスの自動配布

● DNS サーバー
→ データベース専用サーバーソフト

● ファイルサーバー
→ 社内共有フォルダ

● Hyper-V
→ 仮想化機能（UTM のようなもの）
```

- Windows 10 / 11 → 個人向けPC OS  
- Windows Server → 企業のネットワークを支えるサーバー用 OS
- サーバーOSとクライアントOSの違いは以下を参照
     - https://www.winserver.ne.jp/column/about_serveros-clientos/

</details>

<details>
<summary>Active Directory Connectorとは？</summary>
Active Directory のユーザー情報を、クラウド側にも自動で同期してくれる仕組み。オンプレAD にアカウントを作れば、クラウドにも反映されるようにする「同期の中間役」。
</details>

<details>
<summary>グローバルユーザーを「最も近くて速い AWS リージョン」へ自動ルーティングし、かつ “固定IP” を提供するネットワーク高速化サービスといえば？</summary>
AWS Global Accelerator。Elastic IP は リージョン固定なので、グローバルに静的IPを共有したいならGlobal Acceleratorを使う。どれだけリージョンを増やしてもお客様に見せる IP は常に同じ。
</details>

<details>
<summary>AWS Elastic Disaster Recoveryとは？</summary>
オンプレや他クラウドのサーバーを AWS にリアルタイム複製し、障害発生時には秒〜分で AWS 上で復旧できる DR 専用サービス。平常時はAWS側では稼働しない仕組みであり、通常はオンプレ（または他クラウド）が稼働、AWS 側は待機状態です。＝ ハイブリッド同時稼働にはしないサービスです。
</details>

## 1問目：EBSの暗号化

ある企業では、多数の Amazon EC2 インスタンスに 暗号化されていない Amazon EBS ボリューム が接続されていることがセキュリティ監査で判明しました。ソリューションアーキテクトは、次の2つを求められています。
- 既存の暗号化されていない EBS ボリュームを暗号化すること
- 今後、新しく作られる EBS ボリュームが暗号化されていない状態にならないようにすること

これらの要件を満たすために、ソリューションアーキテクトはどちらの手順を実行する必要がありますか？

- A. AWS CLI で暗号化されていない既存ボリュームを検出し、そのまま暗号化するスクリプトを実行する。
- B. 暗号化されていない各ボリュームからスナップショットを作成し、そのスナップショットから 暗号化された新しい EBS ボリューム を作成して既存ボリュームと入れ替える。さらに、EBS のデフォルト暗号化（Default EBS Encryption）を有効にする。

<details>
<summary>答え</summary>
A,C

- CLI から 既存の EBS ボリュームを直接暗号化する API は存在しない。

```sh
非暗号化ボリューム
     ↓ snapshot
暗号化された snapshot
     ↓ create-volume
暗号化されたボリューム（新しいディスク）
```

</details>

## 2問目：ログ監視

ある企業では、Application Load Balancer (ALB) の背後にある Amazon EC2 インスタンスにデプロイされたアプリケーションがあります。インスタンスは Auto Scaling グループに属しています。このアプリケーションには予測不可能なワークロードがあり、頻繁にスケールアウトとスケールインが行われます。同社の開発チームは、アプリケーションのログを分析して、アプリケーションのパフォーマンスを改善する方法を見つけたいと考えています。しかし、インスタンスがスケールインすると、ログは利用できなくなります。

スケールインイベント後にアプリケーションログを表示できるようにするソリューションを選択してください。

- A. ALB のアクセスログを有効にします。ログを Amazon S3 バケットに保存します。
- B. 統合 CloudWatch エージェントを使用して、Amazon CloudWatch Logs にログを公開するように EC2 インスタンスを設定します。
- C. AWS X-Ray トレースを使用してアプリケーションを計測します。

<details>
<summary>答え</summary>
B

- ALB アクセスログは クライアント → アプリケーションまでの HTTP リクエスト情報。アプリケーションの内部まではログが取れない。
- X-Ray はアプリの動作経路（トレース）を記録するツールであり、アプリケーションログとは全く別物。
  - オブザーバビリティを実現するサービスでもあるな。今までの監視は事故ってからじゃないと動けなかったんやけど、事故る前に気づこうよって考え方。

</details>


## 3問目：Kinesis Data Streams
ある企業は、大都市全体の交通パターンを監視する IoT センサーを備えています。同社は、センサーからデータを読み取り、収集し、データの集計を実行したいと考えています。

ソリューションアーキテクトは、IoT デバイスが Amazon Kinesis Data Streams にストリーミングするソリューションを設計します。複数のアプリケーションがストリームからデータを読み込んでいます。しかし、一部のコンシューマでスロットリングが発生し、定期的に ReadProvisionedThroughputExceeded エラーが発生します。

この問題を解決する最適な方法を選択してください。（3つ選択）

- A. ストリームを再シャードして、ストリーム内のシャード数を増やします。
  B. Kinesis Producer Library (KPL) を使用します。ポーリング頻度を調整します。
- C. 拡張ファンアウト機能を備えたコンシューマーを使用します。
- D. ストリームを再シャードして、ストリーム内のシャード数を減らします。
- E. コンシューマロジックでエラーの再試行とエクスポネンシャルバックオフメカニズムを使用します。
- F. 動的パーティショニングを使用するようにストリームを構成します。

<details>
<summary>答え</summary>
A,C,E
<img width="1024" height="249" alt="image" src="https://github.com/user-attachments/assets/448eb8d6-613c-448a-97bd-5ef365f92141" />

- シャードが不足していると 読み取り競合 が発生し、「ReadProvisionedThroughputExceeded」。シャード増加は最も基本的なスループット改善策。
- 拡張ファンアウト（Enhanced Fan-Out, EFO）は、Kinesis Data Streams の各コンシューマに“専用のデータ配信レーン”を割り当てる機能。通常であればシャードを複数コンシューマが取り合うが、EFOを使うと取り合いがなくなる。
- KPLは、Kinesis へデータを高速かつ効率よく PUT するためのProducer 専用のクライアントライブラリ。
- Kinesis Data Streams には “動的パーティショニング” という機能は存在しない。Kinesis Firehose の話と混同している可能性。
     - Data Streams は S3 に書き込んだり、パーティションを作ったりしない。それをやるのはコンシューマアプリの責任。
     - Firehose の役割はデータを最終保存先に届ける輸送サービスであり、アプリケーションが不要なように設計されている。

</details>
